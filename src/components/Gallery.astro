---
import ProjectCard from './ProjectCard.astro';
import ScrollIndicator from './ScrollIndicator.astro';

interface Project {
  id: string;
  title: string;
  category: string;
  thumbnail: string;
  shortDescription: string;
  fullDescription: string;
  images: string[];
  year?: string;
  location?: string;
  type?: string;
}

interface Props {
  projects: Project[];
}

const { projects } = Astro.props;

const residential = projects.filter(p => p.category === 'residential');
const commercial = projects.filter(p => p.category === 'commercial');
---

<main class="main-gallery">
  <!-- Mobile: Horizontal Rows (hidden on desktop) -->
  <div class="gallery-row-container" data-category="residential">
    <div class="gallery-row" data-gallery-id="residential">
      {residential.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
    <ScrollIndicator count={residential.length} galleryId="residential" />
  </div>

  <div class="gallery-row-container" data-category="commercial">
    <div class="gallery-row" data-gallery-id="commercial">
      {commercial.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
    <ScrollIndicator count={commercial.length} galleryId="commercial" />
  </div>

  <!-- Desktop: Sliding Layout -->
  <!-- Order: [left-panel] | Col1 | Contact | Col2 | [right-panel] -->

  <!-- Off-screen Left Project Detail (slides in from left for Col1 clicks) -->
  <div class="project-detail project-detail--left" id="project-detail-left">
    <div class="project-detail__panel">
      <div class="project-detail__content">
        <div class="project-detail__meta">
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Year</span>
            <span class="project-detail__meta-value" data-field="year"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Location</span>
            <span class="project-detail__meta-value" data-field="location"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Type</span>
            <span class="project-detail__meta-value" data-field="type"></span>
          </div>
        </div>
        <p class="project-detail__description" data-field="description"></p>
        <div class="project-detail__gallery" data-field="gallery"></div>
      </div>
    </div>
  </div>

  <!-- Column 1: Residential Projects -->
  <div class="gallery-column-container gallery-column-container--left">
    <div class="gallery-column gallery-column--left" data-gallery-id="column-left">
      {residential.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
  </div>

  <!-- Contact Sidebar (center) -->
  <aside class="contact-sidebar">
    <div class="contact-sidebar__spine">
      <h1 class="site-title">IN RECEIPT</h1>
      <div class="site-contact">
        <span>123 Design Street, Los Angeles CA 90012</span>
        <span>hello@inreceipt.com</span>
      </div>
    </div>
  </aside>

  <!-- Column 2: Commercial Projects -->
  <div class="gallery-column-container gallery-column-container--right">
    <div class="gallery-column gallery-column--right" data-gallery-id="column-right">
      {commercial.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
  </div>

  <!-- Off-screen Right Project Detail (slides in from right for Col2 clicks) -->
  <div class="project-detail project-detail--right" id="project-detail-right">
    <div class="project-detail__panel">
      <div class="project-detail__content">
        <div class="project-detail__meta">
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Year</span>
            <span class="project-detail__meta-value" data-field="year"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Location</span>
            <span class="project-detail__meta-value" data-field="location"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Type</span>
            <span class="project-detail__meta-value" data-field="type"></span>
          </div>
        </div>
        <p class="project-detail__description" data-field="description"></p>
        <div class="project-detail__gallery" data-field="gallery"></div>
      </div>
    </div>
  </div>
</main>
