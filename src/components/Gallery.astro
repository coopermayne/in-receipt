---
import ProjectCard from './ProjectCard.astro';
import ScrollIndicator from './ScrollIndicator.astro';

interface Project {
  id: string;
  title: string;
  category: string;
  thumbnail: string;
  shortDescription: string;
  fullDescription: string;
  images: string[];
  year?: string;
  location?: string;
  type?: string;
}

interface Props {
  projects: Project[];
}

const { projects } = Astro.props;

const residential = projects.filter(p => p.category === 'residential');
const commercial = projects.filter(p => p.category === 'commercial');
---

<main class="main-gallery">
  <!-- Desktop: Contact Sidebar -->
  <aside class="contact-sidebar">
    <div class="contact-sidebar__content">
      <p class="contact-sidebar__name">Studio Name</p>
      <p class="contact-sidebar__title">Architecture & Design</p>
      <a href="mailto:hello@studio.com" class="contact-sidebar__link">hello@studio.com</a>
      <a href="tel:+15551234567" class="contact-sidebar__link">+1 555 123 4567</a>
      <a href="#" class="contact-sidebar__link">Instagram</a>
    </div>
    <h1 class="site-title">IN RECEIPT</h1>
  </aside>

  <!-- Mobile: Horizontal Rows -->
  <div class="gallery-row-container" data-category="residential">
    <div class="gallery-row" data-gallery-id="residential">
      {residential.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
    <ScrollIndicator count={residential.length} galleryId="residential" />
  </div>

  <div class="gallery-row-container" data-category="commercial">
    <div class="gallery-row" data-gallery-id="commercial">
      {commercial.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
    <ScrollIndicator count={commercial.length} galleryId="commercial" />
  </div>

  <!-- Desktop: Vertical Columns -->
  <div class="gallery-column-container gallery-column-container--left">
    <div class="gallery-column gallery-column--left" data-gallery-id="column-left">
      {residential.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
  </div>

  <div class="gallery-column-container gallery-column-container--right">
    <div class="gallery-column gallery-column--right" data-gallery-id="column-right">
      {commercial.map((project, index) => (
        <ProjectCard {...project} isFirst={index === 0} />
      ))}
    </div>
  </div>

  <!-- Off-screen Project Detail (white line + content, slides in from right) -->
  <div class="project-detail" id="project-detail">
    <div class="project-detail__line"></div>
    <div class="project-detail__panel">
      <button class="project-detail__close" aria-label="Close">X</button>
      <div class="project-detail__content">
        <div class="project-detail__meta">
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Year</span>
            <span class="project-detail__meta-value" id="panel-year"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Location</span>
            <span class="project-detail__meta-value" id="panel-location"></span>
          </div>
          <div class="project-detail__meta-item">
            <span class="project-detail__meta-label">Type</span>
            <span class="project-detail__meta-value" id="panel-type"></span>
          </div>
        </div>
        <p class="project-detail__description" id="panel-description"></p>
        <div class="project-detail__gallery" id="panel-gallery"></div>
      </div>
    </div>
  </div>
</main>
