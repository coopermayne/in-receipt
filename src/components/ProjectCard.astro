---
interface Props {
  id: string;
  title: string;
  thumbnail: string;
  shortDescription: string;
  fullDescription: string;
  images: string[];
  year?: string;
  location?: string;
  type?: string;
  isFirst?: boolean;
}

const { id, title, thumbnail, shortDescription, fullDescription, images, year, location, type, isFirst = false } = Astro.props;

const projectData = JSON.stringify({ images, year, location, type });
---

<article
  class="project-card"
  data-project-id={id}
  data-project-title={title}
  data-project-description={fullDescription}
  data-project-data={projectData}
>
  <div class="project-card__inner">
    <div class="project-card__image-container">
      <img
        class="project-card__image"
        src={thumbnail}
        alt={title}
        loading={isFirst ? "eager" : "lazy"}
        fetchpriority={isFirst ? "high" : "auto"}
        data-thumbnail={thumbnail}
      />
    </div>
    <div class="project-card__content">
      <h2 class="project-card__title">{title}</h2>
      <p class="project-card__description">{shortDescription}</p>
    </div>
  </div>

  <!-- Mobile: Preloaded project content (hidden until clicked) -->
  <div class="project-card__expanded">
    <button class="project-card__close" aria-label="Close">&times;</button>
    <div class="project-card__expanded-content">
      <div class="project-card__expanded-meta">
        <div class="project-card__expanded-meta-item">
          <span class="project-card__expanded-meta-label">Year</span>
          <span class="project-card__expanded-meta-value">{year || '—'}</span>
        </div>
        <div class="project-card__expanded-meta-item">
          <span class="project-card__expanded-meta-label">Location</span>
          <span class="project-card__expanded-meta-value">{location || '—'}</span>
        </div>
        <div class="project-card__expanded-meta-item">
          <span class="project-card__expanded-meta-label">Type</span>
          <span class="project-card__expanded-meta-value">{type || '—'}</span>
        </div>
      </div>
      <p class="project-card__expanded-description">{fullDescription}</p>
      <div class="project-card__expanded-gallery">
        {images.map((src) => (
          <img src={src} alt="Project image" loading="lazy" />
        ))}
      </div>
    </div>
  </div>
</article>
